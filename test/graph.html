<!DOCTYPE html>
<html>

<head>
    <title>jsbayes discrete bayesian belief network visualization and interaction example</title>
    <style>
        svg { border: 1px solid black; }
        svg g rect.node-shape { border-radius: 5px !important; fill:#ffecb3 !important; cursor: move; }
        svg g text.node-name { font-weight: 800 !important }
        svg g rect.node-bar { fill: green !important }
        svg g text.node-value { fill:rgb(0,0,0) !important; font-size: 15px; cursor: pointer; }
        svg line.edge-line { stroke:rgb(0,0,0) !important }
        svg path.edge-head { fill:rgb(0,0,0) !important }
    </style>
    <meta charset="UTF-8" />
    <script src="../node_modules/d3/d3.js"></script>
    <script src="../node_modules/lodash/lodash.js"></script>
    <script src="../node_modules/graphlib/dist/graphlib.core.js"></script>
    <script src="../node_modules/dagre/dist/dagre.core.js"></script>
    <script src="../node_modules/jsbayes/jsbayes.js"></script>
    <script src="../node_modules/jsbayes-viz/jsbayes-viz.js"></script>
    <script src="../node_modules/jquery/dist/jquery.js"></script>
    <script src="bayes.js"></script>
    <script>
        $(document).ready(function() {
            let data = {
                "name": "Rete Bayesiana A",

                "databaseWriteName": "Influx2",
                "refreshTime": 5000,

                "nodes": [
                    {
                        "id": "A",
                        "name": "Node A",
                        "parents": ["B"],

                        "states": [
                            {"name": "State 0", "trigger": "%v>=90"},
                            {"name": "State 1", "trigger": "40<%v<90"},
                            {"name": "State 2", "trigger": "%v<=40"}
                        ],
                        "cpt": [
                            [0.4, 0.1, 0.5],
                            [0.2, 0.2, 0.6]
                        ],

                        "sensor": {
                            "databaseSensorName": "Influx1",
                            "databaseSensorTable": "Server1",
                            "databaseSensorColumn": "CPU"
                        }
                    },
                    {
                        "id": "B",
                        "name": "Node B",
                        "parents": [],

                        "states": [
                            {"name": "State 0", "trigger": "%v>=50"},
                            {"name": "State 1", "trigger": "%v<50"}
                        ],
                        "cpt": [
                            [0.6, 0.4]
                        ],

                        "sensor": {}
                    },
                    {
                        "id": "C",
                        "name": "Node C",
                        "parents": ["A", "B"],

                        "states": [
                            {"name": "State 0", "trigger": "%v>=50"},
                            {"name": "State 1", "trigger": "0<=%v<50"}
                        ],
                        "cpt": [
                            [0.4, 0.6],
                            [0.2, 0.8],

                            [0.3, 0.7],
                            [0.4, 0.6],

                            [0.1, 0.9],
                            [0.7, 0.3]
                        ],

                        "sensor": {}
                    }
                ]
            };

            let graph = getGraph(data);

            let g = jsbayesviz.fromGraph(graph);

            jsbayesviz.draw({
                id: '#bbn',
                width: 800,
                height: 800,
                graph: g,
                samples: 15000
            });
        });
    </script>
</head>

<body>
<svg id="bbn"></svg>
</body>

</html>
